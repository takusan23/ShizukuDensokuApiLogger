package io.github.takusan23.shizukudensokuapilogger

object ErrorResolve3gpp {

    /** LTE 3GPP TS 24.301 Sec 9.9.3.9 よりエラーコードの解決 */
    fun resolveCauseFromTs24301(cause: Int): String? = Ts24301ErrorTable.entries.firstOrNull { it.bit == cause }?.name

    /** NR 3GPP TS 24.501 Sec 9.11.3.2 よりエラーコードの解決 */
    fun resolveCauseFromTS24501(cause: Int): String? = TS24501ErrorTable.entries.firstOrNull { it.bit == cause }?.name

    /** NR 3GPP 24.501 Annex A よりエラーコードの解決 */
    fun resolveCauseFromTs24501AnnexA(number: Int) = TS24501AnnexATable.entries.firstOrNull { it.number == number }?.name

    private enum class Ts24301ErrorTable(val bit: Int) {
        IMSI_UNKNOWN_IN_HSS(0b0100_0000),
        ILLEGAL_UE(0b1100_0000),
        IMEI_NOT_ACCEPTED(0b1010_0000),
        ILLEGAL_ME(0b0110_0000),
        EPS_SERVICES_NOT_ALLOWED(0b1110_0000),
        EPS_AND_NON_EPS_SERVICES_NOT_ALLOWED(0b0001_0000),
        UE_IDENTITY_CANNOT_BE_DERIVED_BY_THE_NETWORK(0b1001_0000),
        IMPLICITLY_DETACHED(0b0101_0000),
        PLMN_NOT_ALLOWED(0b1101_0000),
        TRACKING_AREA_NOT_ALLOWED(0b0011_0000),
        ROAMING_NOT_ALLOWED_IN_THIS_TRACKING_AREA(0b1011_0000),
        EPS_SERVICES_NOT_ALLOWED_IN_THIS_PLMN(0b0111_0000),
        NO_SUITABLE_CELLS_IN_TRACKING_AREA(0b1111_0000),
        MSC_TEMPORARILY_NOT_REACHABLE(0b0000_1000),
        NETWORK_FAILURE(0b1000_1000),
        CS_DOMAIN_NOT_AVAILABLE(0b0100_1000),
        ESM_FAILURE(0b1100_1000),
        MAC_FAILURE(0b0010_1000),
        SYNCH_FAILURE(0b1010_1000),
        CONGESTION(0b0110_1000),
        UE_SECURITY_CAPABILITIES_MISMATCH(0b1110_1000),
        SECURITY_MODE_REJECTED_UNSPECIFIED(0b0001_1000),
        NOT_AUTHORIZED_FOR_THIS_CSG(0b1001_1000),
        NON_EPS_AUTHENTICATION_UNACCEPTABLE(0b0101_1000),
        REDIRECTION_TO_5GCN_REQUIRED(0b1111_1000),
        REQUESTED_SERVICE_OPTION_NOT_AUTHORIZED_IN_THIS_PLMN(0b1100_0100),
        IAB_NODE_OPERATION_NOT_AUTHORIZED(0b0010_0100),
        CS_SERVICE_TEMPORARILY_NOT_AVAILABLE(0b1110_0100),
        NO_EPS_BEARER_CONTEXT_ACTIVATED(0b0001_0100),
        SEVERE_NETWORK_FAILURE(0b0101_0100),
        PLMN_NOT_ALLOWED_TO_OPERATE_AT_THE_PRESENT_UE_LOCATION(0b0111_0010),
        PROCEDURE_CANNOT_BE_COMPLETED_DUE_TO_UNAVAILABLE_FEEDER_LINK_WHILE_MME_IS_OPERATING_IN_S1_MODE(0b1100_1010),
        SEMANTICALLY_INCORRECT_MESSAGE(0b1111_1010),
        INVALID_MANDATORY_INFORMATION(0b0000_0110),
        MESSAGE_TYPE_NON_EXISTENT_OR_NOT_IMPLEMENTED(0b1000_0110),
        MESSAGE_TYPE_NOT_COMPATIBLE_WITH_THE_PROTOCOL_STATE(0b0100_0110),
        INFORMATION_ELEMENT_NON_EXISTENT_OR_NOT_IMPLEMENTED(0b1100_0110),
        CONDITIONAL_IE_ERROR(0b0010_0110),
        MESSAGE_NOT_COMPATIBLE_WITH_THE_PROTOCOL_STATE(0b1010_0110),
        PROTOCOL_ERROR_UNSPECIFIED(0b1111_0110)
    }

    private enum class TS24501ErrorTable(val bit: Int) {
        ILLEGAL_UE(0b1100_0000),
        PEI_NOT_ACCEPTED(0b1010_0000),
        ILLEGAL_ME(0b0110_0000),
        FIVE_GS_SERVICES_NOT_ALLOWED(0b1110_0000),
        UE_IDENTITY_CANNOT_BE_DERIVED_BY_THE_NETWORK(0b1001_0000),
        IMPLICITLY_DE_REGISTERED(0b0101_0000),
        PLMN_NOT_ALLOWED(0b1101_0000),
        TRACKING_AREA_NOT_ALLOWED(0b0011_0000),
        ROAMING_NOT_ALLOWED_IN_THIS_TRACKING_AREA(0b1011_0000),
        NO_SUITABLE_CELLS_IN_TRACKING_AREA(0b1111_0000),
        MAC_FAILURE(0b0010_1000),
        SYNCH_FAILURE(0b1010_1000),
        CONGESTION(0b0110_1000),
        UE_SECURITY_CAPABILITIES_MISMATCH(0b1110_1000),
        SECURITY_MODE_REJECTED_UNSPECIFIED(0b0001_1000),
        NON_5G_AUTHENTICATION_UNACCEPTABLE(0b0101_1000),
        N1_MODE_NOT_ALLOWED(0b1101_1000),
        RESTRICTED_SERVICE_AREA(0b0011_1000),
        REDIRECTION_TO_EPC_REQUIRED(0b1111_1000),
        IAB_NODE_OPERATION_NOT_AUTHORIZED(0b0010_0100),
        LADN_NOT_AVAILABLE(0b1101_0100),
        NO_NETWORK_SLICES_AVAILABLE(0b0111_1100),
        MAXIMUM_NUMBER_OF_PDU_SESSIONS_REACHED(0b1000_0010),
        INSUFFICIENT_RESOURCES_FOR_SPECIFIC_SLICE_AND_DNN(0b1100_0010),
        INSUFFICIENT_RESOURCES_FOR_SPECIFIC_SLICE(0b1010_0010),
        NGKSI_ALREADY_IN_USE(0b1110_0010),
        NON_3GPP_ACCESS_TO_5GCN_NOT_ALLOWED(0b0001_0010),
        SERVING_NETWORK_NOT_AUTHORIZED(0b1001_0010),
        TEMPORARILY_NOT_AUTHORIZED_FOR_THIS_SNPN(0b0101_0010),
        PERMANENTLY_NOT_AUTHORIZED_FOR_THIS_SNPN(0b1101_0010),
        NOT_AUTHORIZED_FOR_THIS_CAG_OR_AUTHORIZED_FOR_CAG_CELLS_ONLY(0b0011_0010),
        WIRELINE_ACCESS_AREA_NOT_ALLOWED(0b1011_0010),
        PLMN_NOT_ALLOWED_TO_OPERATE_AT_THE_PRESENT_UE_LOCATION(0b0111_0010),
        UAS_SERVICES_NOT_ALLOWED(0b1111_0010),
        DISASTER_ROAMING_FOR_THE_DETERMINED_PLMN_WITH_DISASTER_CONDITION_NOT_ALLOWED(0b0000_1010),
        SELECTED_N3IWF_IS_NOT_COMPATIBLE_WITH_THE_ALLOWED_NSSAI(0b1000_1010),
        SELECTED_TNGF_IS_NOT_COMPATIBLE_WITH_THE_ALLOWED_NSSAI(0b0100_1010),
        PAYLOAD_WAS_NOT_FORWARDED(0b0101_1010),
        DNN_NOT_SUPPORTED_OR_NOT_SUBSCRIBED_IN_THE_SLICE(0b1101_1010),
        INSUFFICIENT_USER_PLANE_RESOURCES_FOR_THE_PDU_SESSION(0b0011_1010),
        ONBOARDING_SERVICES_TERMINATED(0b1011_1010),
        USER_PLANE_POSITIONING_NOT_AUTHORIZED(0b0111_1010),
        SEMANTICALLY_INCORRECT_MESSAGE(0b1111_1010),
        INVALID_MANDATORY_INFORMATION(0b0000_0110),
        MESSAGE_TYPE_NON_EXISTENT_OR_NOT_IMPLEMENTED(0b1000_0110),
        MESSAGE_TYPE_NOT_COMPATIBLE_WITH_THE_PROTOCOL_STATE(0b0100_0110),
        INFORMATION_ELEMENT_NON_EXISTENT_OR_NOT_IMPLEMENTED(0b1100_0110),
        CONDITIONAL_IE_ERROR(0b0010_0110),
        MESSAGE_NOT_COMPATIBLE_WITH_THE_PROTOCOL_STATE(0b1010_0110),
        PROTOCOL_ERROR_UNSPECIFIED(0b1111_0110)
    }

    private enum class TS24501AnnexATable(val number: Int) {
        ILLEGAL_UE(3),
        ILLEGAL_ME(6),
        UE_IDENTITY_CANNOT_BE_DERIVED(9),
        IMPLICITLY_DE_REGISTERED(10),
        PEI_NOT_ACCEPTED(5),
        FIVE_GS_SERVICES_NOT_ALLOWED(7),
        PLMN_NOT_ALLOWED(11),
        TRACKING_AREA_NOT_ALLOWED(12),
        ROAMING_NOT_ALLOWED_IN_THIS_TRACKING_AREA(13),
        NO_SUITABLE_CELLS_IN_TRACKING_AREA(15),
        N1_MODE_NOT_ALLOWED(27),
        REDIRECTION_TO_EPC_REQUIRED(31),
        IAB_NODE_OPERATION_NOT_AUTHORIZED(36),
        NON_3GPP_ACCESS_TO_5GCN_NOT_ALLOWED(72),
        TEMPORARILY_NOT_AUTHORIZED_FOR_THIS_SNPN(74),
        PERMANENTLY_NOT_AUTHORIZED_FOR_THIS_SNPN(75),
        NOT_AUTHORIZED_FOR_THIS_CAG_OR_AUTHORIZED_FOR_CAG_CELLS_ONLY(76),
        WIRELINE_ACCESS_AREA_NOT_ALLOWED(77),
        UAS_SERVICES_NOT_ALLOWED(79),
        DISASTER_ROAMING_FOR_THE_DETERMINED_PLMN_WITH_DISASTER_CONDITION_NOT_ALLOWED(80),
        USER_PLANE_POSITIONING_NOT_AUTHORIZED(94),
        MAC_FAILURE(20),
        SYNCH_FAILURE(21),
        CONGESTION(22),
        UE_SECURITY_CAPABILITIES_MISMATCH(23),
        SECURITY_MODE_REJECTED_UNSPECIFIED(24),
        NON_5G_AUTHENTICATION_UNACCEPTABLE(26),
        RESTRICTED_SERVICE_AREA(28),
        LADN_NOT_AVAILABLE(43),
        NO_NETWORK_SLICES_AVAILABLE(62),
        MAXIMUM_NUMBER_OF_PDU_SESSIONS_REACHED(65),
        INSUFFICIENT_RESOURCES_FOR_SPECIFIC_SLICE_AND_DNN(67),
        INSUFFICIENT_RESOURCES_FOR_SPECIFIC_SLICE(69),
        NGKSI_ALREADY_IN_USE(71),
        SERVING_NETWORK_NOT_AUTHORIZED(73),
        PLMN_NOT_ALLOWED_TO_OPERATE_AT_THE_PRESENT_UE_LOCATION(78),
        SELECTED_N3IWF_IS_NOT_COMPATIBLE_WITH_THE_ALLOWED_NSSAI(81),
        SELECTED_TNGF_IS_NOT_COMPATIBLE_WITH_THE_ALLOWED_NSSAI(82),
        PAYLOAD_WAS_NOT_FORWARDED(90),
        DNN_NOT_SUPPORTED_OR_NOT_SUBSCRIBED_IN_THE_SLICE(91),
        INSUFFICIENT_USER_PLANE_RESOURCES_FOR_THE_PDU_SESSION(92),
        ONBOARDING_SERVICES_TERMINATED(93),
        SEMANTICALLY_INCORRECT_MESSAGE(95),
        INVALID_MANDATORY_INFORMATION(96),
        MESSAGE_TYPE_NON_EXISTENT_OR_NOT_IMPLEMENTED(97),
        MESSAGE_TYPE_NOT_COMPATIBLE_WITH_PROTOCOL_STATE(98),
        INFORMATION_ELEMENT_NON_EXISTENT_OR_NOT_IMPLEMENTED(99),
        CONDITIONAL_IE_ERROR(100),
        MESSAGE_NOT_COMPATIBLE_WITH_PROTOCOL_STATE(101),
        PROTOCOL_ERROR_UNSPECIFIED(111)
    }

}